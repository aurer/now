var App={progressElements:[],segmentElements:[],init:function(){this.svg=document.querySelector("svg.clock"),this.setSize(),this.addProps(),this.setupCircles(),this.setupSegments(),this.setTimouts(),this.enableDisplayOptions(),this.updateMinute(),this.updateHour(),this.updateDay(),this.updateWeek(),this.updateMonth(),this.updateYear()},addProps:function(){SVGElement.prototype.circumference=function(){return 2*this.getAttribute("r")*Math.PI}},setupCircles:function(){for(var e=App.svg.querySelectorAll("circle"),t=0;t<e.length;t++){var r=e[t],s=r.getAttribute("class"),n=r.cloneNode(!0);n.setAttribute("stroke-dasharray",r.circumference()),n.setAttribute("stroke-dashoffset",r.circumference()),n.setAttribute("class",s+" progress"),App.progressElements[s]=App.svg.appendChild(n);var a=r.cloneNode(!0);a.setAttribute("class",s+" segments"),App.segmentElements[s]=App.svg.appendChild(a)}},setupSegments:function(){function e(e){var t=App.segmentElements[e],r=new Date,s={minute:60,hour:60,day:24,week:7,month:new Date(r.getFullYear(),r.getMonth(),0).getDate(),year:12};return 2*t.getAttribute("r")*Math.PI/s[e]-1}App.segmentElements.minute.setAttribute("stroke-dasharray","1 "+e("minute")),App.segmentElements.hour.setAttribute("stroke-dasharray","1 "+e("hour")),App.segmentElements.day.setAttribute("stroke-dasharray","1 "+e("day")),App.segmentElements.week.setAttribute("stroke-dasharray","1 "+e("week")),App.segmentElements.month.setAttribute("stroke-dasharray","1 "+e("month")),App.segmentElements.year.setAttribute("stroke-dasharray","1 "+e("year"))},setSize:function(){var e=window.innerHeight,t=window.innerwidth,r=t>e?t:e;App.svg.setAttribute("height",r-20),App.svg.setAttribute("width",r-20)},enableDisplayOptions:function(){var e=function(){App.svg.classList.toggle("hide-details")};setTimeout(e,2e3),document.body.onclick=e,document.body.ontouchend=e},updateMinute:function(){var e=App.progressElements.minute,t=(new Date).getSeconds(),r=t/60*100,s=e.circumference()-e.circumference()/100*r;e.setAttribute("stroke-dashoffset",s),0==r?e.setAttribute("data-ending",!0):e.removeAttribute("data-ending")},updateHour:function(){var e=App.progressElements.hour,t=new Date,r=t.getMinutes();r+=t.getSeconds()/60;var s=r/60*100;e.setAttribute("stroke-dasharray",e.circumference()),e.setAttribute("stroke-dashoffset",e.circumference()-e.circumference()/100*s)},updateDay:function(){var e=App.progressElements.day,t=(new Date).getHours(),r=60*t+(new Date).getMinutes(),s=r/1440*100;e.setAttribute("stroke-dasharray",e.circumference()),e.setAttribute("stroke-dashoffset",e.circumference()-e.circumference()/100*s)},updateWeek:function(){var e=App.progressElements.week,t=new Date,r=(new Date).getDay(),s=t.getHours(),n=(new Date).getMinutes()/60,a=(s+n)/168*100,i=r/7*100+a;e.setAttribute("stroke-dasharray",e.circumference()),e.setAttribute("stroke-dashoffset",e.circumference()-e.circumference()/100*i)},updateMonth:function(){var e=App.progressElements.month,t=new Date,r=t.getDate(),s=new Date(t.getYear(),t.getMonth(),0).getDate(),n=t.getHours(),a=n/24,i=(r+a)/s*100;e.setAttribute("stroke-dasharray",e.circumference()),e.setAttribute("stroke-dashoffset",e.circumference()-e.circumference()/100*i)},updateYear:function(){var e=App.progressElements.year,t=new Date,r=new Date(t.getFullYear(),0,1),s=Math.round((t-r)/1e3/60/60/24+.5,0),n=100/365*s;e.setAttribute("stroke-dasharray",e.circumference()),e.setAttribute("stroke-dashoffset",e.circumference()-e.circumference()/100*n)},setTimouts:function(){var e=new Date,t=e.getSeconds(),r=1e3*(60-t);setInterval(App.updateMinute.bind(this),1e3),setInterval(App.updateHour.bind(this),1e3),setTimeout(function(){setInterval(function(){App.updateDay(),App.updateWeek(),App.updateMonth(),App.updateYear()},6e4),App.updateDay(),App.updateWeek(),App.updateMonth(),App.updateYear()},r)}};App.init();